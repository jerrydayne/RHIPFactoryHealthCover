<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>HealthCover- website by RHIPFactory</title>
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/font-awesome.min.css" rel="stylesheet">
	<link href="css/datepicker3.css" rel="stylesheet">
	<link href="css/styles.css" rel="stylesheet">

	<!--Custom Font-->
	<link href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,400i,500,500i,600,600i,700,700i"
		rel="stylesheet">
</head>

<body>

	<nav class="navbar navbar-custom navbar-fixed-top" role="navigation">
		<div class="navbarH">
			<div class="containH">
				<div class="logo_div">
					<a href="index.html">
						<img class="logo" src="./images/logo.png" alt="HealthCover" /></a>
				</div>
			</div>
		</div>
	</nav>
	<div id="sidebar-collapse" class="col-sm-3 col-lg-2 sidebar">
		<div class="profile-sidebar">
			<div class="profile-userpic">
				<img src="http://placehold.it/50/30a5ff/fff" class="img-responsive" alt="">
			</div>
			<div class="profile-usertitle">
				<div class="profile-usertitle-name" id="userName"></div>
				<div class="profile-usertitle-status"><span class="indicator label-success"></span>Online</div>
			</div>
			<div class="clear"></div>
		</div>
		<div class="divider"></div>
		<div class="topic"><a href="hmoDB.html">MAIN MENU</a></div>
		<ul class="nav menu">
			<li class="active"><a href="/"><em class="fa fa-home">&nbsp;</em> HOME</a></li>
			<li class="parent "><a data-toggle="collapse" href="#sub-item-1">
					<em class="fa fa-user">&nbsp;</em>My Profile<span data-toggle="collapse" href="#sub-item-1"
						class="icon pull-right"><em class="fa fa-plus"></em></span>
				</a>
				<ul class="children collapse" id="sub-item-1">
					<li><a class="" href="editHMOProfile.html">
							<span class="fa fa-arrow-right">&nbsp;</span> Edit Profile</a>
					</li>
			</li>
			<li><a class="" href="changeHMOPW.html">
					<span class="fa fa-arrow-right">&nbsp;</span> Change Password</a>
			</li>
		</ul>
		</li>
		<li><a href="healthPlans.html"><em class="fa fa-list">&nbsp;</em> Health Plans</a></li>
		<li><a href="serviceProviders.html"><em class="fa fa-list">&nbsp;</em> Service Providers</a></li>
		<li><a href="addPlans.html"><em class="fa fa-plus">&nbsp;</em> Add Plan</a></li>
		<li id="logout"><a href="#"><em class="fa fa-power-off">&nbsp;</em> Logout</a></li>
		</ul>
	</div>
	<!--/.sidebar-->
	<script>
		document.getElementById('logout').addEventListener('click', function (event) {
			localStorage.removeItem('token')
			location.pathname = '/index.html'
		})
	</script>
	<!--content header starts-->
	<div class="col-sm-9 col-sm-offset-3 col-lg-10 col-lg-offset-2 main">
		<div class="row">
			<ol class="breadcrumb">
				<li><a href="#">
						<em class="fa fa-list"></em>
					</a></li>
				<li class="active">Health Plans</li>
			</ol>
		</div>
		<!--content header ends-->

		<!--Contetnt starts-->
		<div class="row">
			<div class="badge col-lg-12">
				<div class="notifyH">
					<div class="notify_div">
						<h4 class="notify">Notifications:</h4>
					</div>
					<div class="notify_links">
						<ul class="notify_items">
							<li><a href="#"><em class="fa fa-bell">&nbsp;</em> (0)</a></li>
						</ul>
					</div>
				</div>
			</div>
			<div class="badge col-lg-12">
				<!--List of HCP's start-->
				<div class="badge col-lg-12">
					<div class="wrap-table100" style="width:90%; margin:3%">
						<div class="table100 ver2 m-b-110">
							<div class="table100-head">
								<table>
									<thead>
										<tr class="row100 head">
											<th class="cell100 column2">Health Plans In Operation</th>
										</tr>
									</thead>
								</table>
							</div>
						</div>
					</div>

					<div class="cover_HMO">
						<div class="table200-head">
						<div id="listPlans" class="insider" style="margin: 5%"></div>
						</div>
					</div>
				</div>
				<!--list of HCP's ends-->
			</div>
		</div>
		<!--content ends-->
	</div>


	<script src="js/jquery-1.11.1.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/chart.min.js"></script>
	<script src="js/chart-data.js"></script>
	<script src="js/easypiechart.js"></script>
	<script src="js/easypiechart-data.js"></script>
	<script src="js/bootstrap-datepicker.js"></script>
	<script src="js/custom.js"></script>
	<script src="js/table.js"></script>

	<!--   Core JS Files   -->
	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
	<script src="./assets/js/core/jquery.min.js" type="text/javascript"></script>
	<script src="./assets/js/core/popper.min.js" type="text/javascript"></script>
	<script src="./assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
	<script src="./assets/js/plugins/moment.min.js"></script>
	<!--	Plugin for the Datepicker, full documentation here: https://github.com/Eonasdan/bootstrap-datetimepicker -->
	<script src="./assets/js/plugins/bootstrap-datetimepicker.js" type="text/javascript"></script>
	<!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
	<script src="./assets/js/plugins/nouislider.min.js" type="text/javascript"></script>
	<!--  Google Maps Plugin    -->
	<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>
	<!-- Control Center for Material Kit: parallax effects, scripts for the example pages etc -->
	<script src="./assets/js/material-kit.js?v=2.0.5" type="text/javascript"></script>
	<script>
		 //getting HMO plan
		// $.ajax ({
		// 	type: 'GET',
		// 	URL: 'http://192.168.0.100:7221/getHMOPlan/5cf0f23c04e35a710dae1ecc',
		// 	dataType: "JSON",
		// 	success : function (data) {
		// 		console.log(data);
		// 	},
		// 	error: function (err) {
		// 		console.log('Error: ' + err);
		// 	}
		// });
		//$.get(`https://healthcoverapi.herokuapp.com/getHMOPlan/${localStorage.getItem('id')}`).done(function(data){
			$.get(`http://localhost:7122/getHMOPlan/${localStorage.getItem('id')}`).done(function(data){
			console.log(data);
			let listPlans = document.getElementById('listPlans');
			for(var i = 0; i < data.length; i++){
				let innerPlans = document.createElement('div')

				console.log(innerPlans)
				innerPlans.classList.add('inner')
				let children = listPlans.appendChild(innerPlans);
				let inners = document.getElementsByClassName('inner');
				for (var index = 0; index < inners.length; index++) {
					if (index === i) {
						children.innerHTML = `
					<h1 id="planType" class="HMO_header">${data[i].planType}</h1>
					<h4 class="listPlan"> Summary: <span id="plansummary">${data[i].summary}</span></h4>
					<h4 class="listPlan"> Features: <span id="planfeature">${data[i].feature}</span></h4>
					<h4 class="listPlan"> Benefits: <span id="planbenefit">${data[i].benefit}</span></h4>
					<h4 class="listPlan"> Exclusion: <span id="planexclusion">${data[i].exclusion}</span></h4>
					<h4 class="listPlan"> About Us: <span id="planaboutUs"></span>${data[i].aboutUs}</p>
					<h4 class="listPlan"> Price (Naira): <span id="planpriceNaira">${data[i].priceNaira}</span></h4>
					<h4 class="listPlan"> price (Dollar): <span id="planpriceDollar">${data[i].priceDollar}</span></h4>

					<div class="row">
							<input type="submit" onclick="document.getElementById('updatePlan-wrapper').style.display='block'" class="btn btn-danger btn-pill" value="Edit plan"></input> 
						
							<!--updatePlan modal start-->
                      <div id="updatePlan-wrapper" class="modal">
                        <form class="modal-content animate">
                      
                            <div class="imgcontainer">
                                <span onclick="document.getElementById('updatePlan-wrapper').style.display='none'" class="closeX" title="close popup">&times;</span>
                            </div>
                      
							<div class="container"> 
					<!--Edit form-->
                <div class="container">
                        <form onsubmit="createPlanFunction(event)" id="plan_form">
                          <div class="row">

                              <div class="wrap-table100" style="width:90%; margin:3%">
                                <div class="table100 ver2 m-b-110">
                                  <div class="table100-head">
                                    <table>
                                      <thead>
                                        <tr class="row100 head">
                                          <th class="cell">UPDATING PLAN</th>
                                        </tr>
                                      </thead>
                                    </table>
                                  </div>
                                </div>
                              </div>
							  
							  <form id="updatePlan">
                              <div class="input-group input-group-icon" style="width:100%;">
                                <select id="planType">
                                  <option value="Plan">Select Plan Type</option>
                                  <option value="Basic">Basic</option>
                                  <option value="Comprehensive">Comprehensive</option>
                                  <option value="Premium">Premium</option>
                                  <option value="Luxury">Luxury</option>
                                </select>
                            </div>

                            <div class="input-group input-group-icon">
                              <input id="hmoId" type="text" placeholder="" value=""  hidden/>
                            </div>

							<div class="input-group input-group-icon">
                              <input id="UpdateSummary" type="text" placeholder="Summary of plan" value="${data[i].summary}" required/>
                              <div class="input-icon"><i class="fa fa-"></i></div>
                            </div>

                            <div class="input-group input-group-icon">
                                    <input id="UpdateFeature" type="text" placeholder="Features of plan"  value="${data[i].feature}" required/>
                                    <div class="input-icon"><i class="fa fa-"></i></div>
                                  </div>
                      
                            <div class="input-group input-group-icon">
                              <input id="UpdateBenefit" type="text" placeholder="Benefits of plan" value="${data[i].benefit}"/>
                              <div class="input-icon"><i class="fa fa-"></i></div>
                            </div>

                            <div class="input-group input-group-icon">
                                    <input id="UpdateExclusion" type="text" placeholder="plan Exclusion" value="${data[i].exclusion}" required/>
                                    <div class="input-icon"><i class="fa fa-"></i></div>
                                  </div>
                                  
                            <div class="input-group input-group-icon">
                                <input id="UpdateAboutUs" type="text" placeholder="About the HMO" value="${data[i].aboutUs}"/>
                                <div class="input-icon"><i class="fa fa-"></i></div>
                              </div>

                              <div class="input-group input-group-icon">
                                <input id="UpdatePriceNaira" type="text" placeholder="price in Naira" value="${data[i].priceNaira}"/>
                                <div class="input-icon"><i class="fa fa-"></i></div>
                              </div>

                              <div class="input-group input-group-icon">
                                <input id="UpdatePriceDollar" type="text" placeholder="price in Dollar" value="${data[i].priceDollar}" />
                                <div class="input-icon"><i class="fa fa-"></i></div>
                              </div>
                            </form>
                            <input type="submit" onclick="updatePlanFunction(event, ${data[i]._id})" class="btn btn-primary btn-pill" value="Update Plan"></input>
                          </div>
                        </form>
                      </div>
           <!--edit form ends-->
                            </div>
                            
                        </form>
					  </div>
					  <!--updatePlan modal ends-->
					  
							<input type="submit" class="btn btn-danger btn-pill"
								value="Delete Plan"></input>
						</div>
				`
					}
				}
				console.log(data)
			// document.getElementById('plansummary').innerText = data[i].summary;
			// document.getElementById('planfeature').innerText = data[i].feature;
			// document.getElementById('planbenefit').innerText = data[i].benefit;
			// document.getElementById('planexclusion').innerText = data[i].exclusion;
			// document.getElementById('planaboutUs').innerText = data[i].aboutUs;
			// document.getElementById('planpriceNaira').innerText = data[i].priceNaira;
			// document.getElementById('planpriceDollar').innerText = data[i].priceDollar;

			}
		}).fail(function (data){
			console.log('Error: ' + data);
		});

function updatePlanFunction(event, id) {
  e.preventDefault();
  const sendObj = {
  planType: $('#planType').val(),
  summary: $('#UpdateSummary').val(),
  feature: $('#UpdateFeature').val(),
  benefit: $('#UpdateBenefit').val(),
  exclusion: $('#exclusion').val(),
  aboutUs: $('#UpdateAboutUs').val(),
  priceNaira: $('#UpdatePriceNaira').val(),
  priceDollar: $('#UpdatepPiceDollar').val(),
  }
  console.log(sendObj);
      //$.patch(`http://healthcoverapi.herokuapp.com/plan/${localStorage.getItem('id')}`,
      $.patch(`http://localhost:7122/plan/${id}`,
      sendObj,
      function (response, status) {
          let userData = response.data;
         console.log('object', userData)
      })
  }
	</script>

	</body>

</html>